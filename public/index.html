<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>distSTRING calculates pairwise distances between all sequences of a DNAStringSet or a AAStringSet â€¢ distSTRING</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="distSTRING calculates pairwise distances between all sequences of a DNAStringSet or a AAStringSet">
<meta property="og:description" content="distSTRING calculates pairwise distances between all sequences of
    a DNAStringSet or a AAStringSet.
    It uses scoring matrices to be used in these pairwise distance calcualtions
    which can be adapted to any scoring for DNA or AA characters. E.g. by using
    literal distances distSTRING calcualtes pairwise IUPAC distances.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">distSTRING</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/V01distSTRINGBasicVignette.html">distSTRING Basic Vignette</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://gitlab.gwdg.de/mpievolbio-it/diststring">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">


<div id="diststring---calculates-pairwise-distances-between-all-sequences-of-a-dnastringset-or-a-aastringset" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#diststring---calculates-pairwise-distances-between-all-sequences-of-a-dnastringset-or-a-aastringset" class="anchor"></a>distSTRING - calculates pairwise distances between all sequences of a DNAStringSet or a AAStringSet</h1></div>
</div>
<div id="installation" class="section level1">
<h1 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h1>
<p>see also here for the R package pages <a href="https://mpievolbio-it.pages.gwdg.de/diststring/">https://mpievolbio-it.pages.gwdg.de/diststring/</a></p>
<div id="r-specific-installation-prerequisites" class="section level2">
<h2 class="hasAnchor">
<a href="#r-specific-installation-prerequisites" class="anchor"></a>R specific installation prerequisites</h2>
<div id="install-packages-from-cran" class="section level3">
<h3 class="hasAnchor">
<a href="#install-packages-from-cran" class="anchor"></a>install packages from <a href="https://cran.r-project.org/web/packages/index.html">cran</a>
</h3>
<p>In most cases you need to first install the following system-wide packages to be able to compile the R dependencies.</p>
<p>Ubuntu/Debian</p>
<pre><code>sudo apt-get install libcurl4-openssl-dev libssl-dev libxml2-dev libglu1-mesa-dev libgit2-dev
#pkgdown dependencies - pkgdown is used to build R package pages
#sudo apt-get install libssh2-1-dev libfontconfig1-dev libharfbuzz-dev libfribidi-dev</code></pre>
<p>CentOS</p>
<pre><code>sudo yum install libcurl-devel openssl-devel libxml2-devel mesa-libGLU-devel libgit2-devel
#pkgdown dependencies - pkgdown is used to build R package pages
#sudo yum install libssh2-devel fontconfig-devel harfbuzz-devel fribidi-devel</code></pre>
<ul>
<li><a href="https://cran.r-project.org/web/packages/Rcpp/index.html">Rcpp</a></li>
<li><a href="https://cran.r-project.org/web/packages/RcppThread/index.html">RcppThread</a></li>
<li><a href="https://cran.r-project.org/web/packages/devtools/index.html">devtools</a></li>
<li><a href="https://cran.r-project.org/web/packages/testthat/index.html">testthat</a></li>
<li><a href="https://cran.r-project.org/web/packages/curl/index.html">curl</a></li>
<li><a href="https://cran.r-project.org/web/packages/seqinr/index.html">seqinr</a></li>
<li><a href="https://cran.r-project.org/web/packages/ape/index.html">ape</a></li>
</ul>
<pre><code><a href="https://rdrr.io/r/utils/install.packages.html">install.packages("Rcpp")
install.packages("RcppThread")
install.packages("devtools")
install.packages("testthat")
install.packages("curl")
install.packages("seqinr")
install.packages("ape")</a></code></pre>
</div>
<div id="install-packages-from-bioconductor" class="section level3">
<h3 class="hasAnchor">
<a href="#install-packages-from-bioconductor" class="anchor"></a>install packages from <a href="https://www.bioconductor.org/">Bioconductor</a>
</h3>
<ul>
<li><a href="http://bioconductor.org/packages/release/bioc/html/Biostrings.html">Biostrings</a></li>
</ul>
<pre><code>if (!requireNamespace("BiocManager", quietly = TRUE))
    install.packages("BiocManager")

BiocManager::install("Biostrings")</code></pre>
</div>
<div id="install-diststring" class="section level3">
<h3 class="hasAnchor">
<a href="#install-diststring" class="anchor"></a>install <a href="https://gitlab.gwdg.de/mpievolbio-it/diststring">distSTRING</a>
</h3>
<pre><code><a href="https://devtools.r-lib.org/">library(devtools)
install_gitlab("mpievolbio-it/diststring", host = "https://gitlab.gwdg.de",
build_vignettes = FALSE, dependencies = FALSE)
#install_github("kullrich/distSTRING", build_vignettes = FALSE, dependencies = FALSE)</a></code></pre>
</div>
</div>
<div id="quick-guide" class="section level2">
<h2 class="hasAnchor">
<a href="#quick-guide" class="anchor"></a>Quick-guide</h2>
<pre><code><a href="https://gitlab.gwdg.de/mpievolbio-it/diststring">library(distSTRING)
## load example sequence data
data("hiv", package="distSTRING")

## calculate pairwise AA distances based on Grantham's distance
aa.dist &lt;- aastring2dist(cds2aa(hiv), score=granthamMatrix())
head(aa.dist$distSTRING)

## create and plot bionj tree
aa.dist.bionj &lt;- ape::bionj(as.dist(aa.dist$distSTRING))
plot(aa.dist.bionj)

## calculate pairwise DNA distances based on IUPAC distance
dna.dist &lt;- dnastring2dist(hiv, score=iupacMatrix())

## create and plot bionj tree
dna.dist.bionj &lt;- ape::bionj(as.dist(dna.dist$distSTRING))
head(dna.dist$distSTRING)

## creation of the association matrix:
association &lt;- cbind(aa.dist.bionj$tip.label, aa.dist.bionj$tip.label)

## cophyloplot
ape::cophyloplot(aa.dist.bionj,
                 dna.dist.bionj,
                 assoc=association,
                 length.line=4,
                 space=28,
                 gap=3,
                 rotate=TRUE)

## calculate pairwise DNA distances based on K80 distance
dna.dist.K80 &lt;- dnastring2dist(hiv, model="K80")

## calculate pairwise AA distances based on getAAMatrix() function from the alakazam package
data("AAMatrix", package="distSTRING")
aa.dist &lt;- aastring2dist(cds2aa(hiv), score=AAMatrix)

## example how to calculate all pairwise kaks values given a MSA
hiv_kaks &lt;- dnastring2kaks(hiv, model="Li")
hiv_kaks &lt;- dnastring2kaks(hiv, model="NG86")

## codon plot - sites under possible positive selection
library(tidyr)
library(dplyr)
library(ggplot2)
hiv.xy &lt;- codonmat2xy(dnastring2codonmat(hiv))
hiv.xy %&gt;% select(Codon,SynMean,NonSynMean,IndelMean) %&gt;%
  gather(variable, values, -Codon) %&gt;% 
  ggplot(aes(x=Codon, y=values)) + 
    geom_line(aes(colour=factor(variable))) + 
    geom_point(aes(colour=factor(variable))) + 
    ggtitle("HIV-1 sample 136 patient 1 from Sweden envelope glycoprotein (env) gene")</a></code></pre>
</div>
<div id="todo" class="section level2">
<h2 class="hasAnchor">
<a href="#todo" class="anchor"></a>TODO</h2>
<ul>
<li>codonmat2pnps : alternative translation tables</li>
</ul>
</div>
<div id="license" class="section level2">
<h2 class="hasAnchor">
<a href="#license" class="anchor"></a>License</h2>
<p>MIT (see LICENSE)</p>
</div>
<div id="contributing-code" class="section level2">
<h2 class="hasAnchor">
<a href="#contributing-code" class="anchor"></a>Contributing Code</h2>
<p>If you would like to contribute to distSTRING, please file an issue so that one can establish a statement of need, avoid redundant work, and track progress on your contribution.</p>
<p>Before you do a pull request, you should always file an issue and make sure that someone from the distSTRING developer team agrees that itâ€™s a problem, and is happy with your basic proposal for fixing it.</p>
<p>Once an issue has been filed and weâ€™ve identified how to best orient your contribution with package development as a whole, <a href="https://docs.github.com/en/github/getting-started-with-github/fork-a-repo">fork</a> the <a href="https://gitlab.gwdg.de/mpievolbio-it/diststring.git">main repo</a>, branch off a <a href="https://docs.github.com/en/github/collaborating-with-issues-and-pull-requests/about-branches">feature branch</a> from <code>master</code>, <a href="https://docs.github.com/en/desktop/contributing-and-collaborating-using-github-desktop/committing-and-reviewing-changes-to-your-project">commit</a> and <a href="https://docs.github.com/en/github/using-git/pushing-commits-to-a-remote-repository">push</a> your changes to your fork and submit a <a href="https://docs.github.com/en/github/collaborating-with-issues-and-pull-requests/proposing-changes-to-your-work-with-pull-requests">pull request</a> for <code>distSTRING:master</code>.</p>
<p>By contributing to this project, you agree to abide by the Code of Conduct terms.</p>
</div>
<div id="bug-reports" class="section level2">
<h2 class="hasAnchor">
<a href="#bug-reports" class="anchor"></a>Bug reports</h2>
<p>Please report any errors or requests regarding <a href="https://gitlab.gwdg.de/mpievolbio-it/diststring">distSTRING</a> to Kristian Ullrich (<a href="mailto:ullrich@evolbio.mpg.de" class="email">ullrich@evolbio.mpg.de</a>)</p>
<p>or use the issue tracker at <a href="https://gitlab.gwdg.de/mpievolbio-it/diststring/issues">https://gitlab.gwdg.de/mpievolbio-it/diststring/issues</a></p>
</div>
<div id="code-of-conduct---participation-guidelines" class="section level2">
<h2 class="hasAnchor">
<a href="#code-of-conduct---participation-guidelines" class="anchor"></a>Code of Conduct - Participation guidelines</h2>
<p>This repository adhere to <a href="http://contributor-covenant.org">Contributor Covenant</a> code of conduct for in any interactions you have within this project. (see <a href="https://gitlab.gwdg.de/mpievolbio-it/diststring/-/blob/master/CODE_OF_CONDUCT.md">Code of Conduct</a>)</p>
<p>See also the policy against sexualized discrimination, harassment and violence for the Max Planck Society <a href="https://www.mpg.de/11961177/code-of-conduct-en.pdf">Code-of-Conduct</a>.</p>
<p>By contributing to this project, you agree to abide by its terms.</p>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://gitlab.gwdg.de/mpievolbio-it/diststring">https://â€‹gitlab.gwdg.de/â€‹mpievolbio-it/â€‹diststring</a>
</li>
<li>Report a bug at <br><a href="https://gitlab.gwdg.de/mpievolbio-it/diststring/issues">https://â€‹gitlab.gwdg.de/â€‹mpievolbio-it/â€‹diststring/â€‹issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="community">
<h2>Community</h2>
<ul class="list-unstyled">
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Kristian K Ullrich <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-4308-9626" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://gitlab.gwdg.de/mpievolbio-it/diststring/-/commits/master"><img src="https://gitlab.gwdg.de/mpievolbio-it/diststring/badges/master/pipeline.svg" alt="pipeline status"></a></li>
<li><a href="CODE_OF_CONDUCT.html"><img src="https://img.shields.io/badge/Contributor%20Covenant-v2.0%20adopted-ff69b4.svg" alt="Contributor Covenant"></a></li>
<li><a href="http://opensource.org/licenses/MIT"><img src="http://img.shields.io/badge/license-MIT-brightgreen.svg" alt="MITlicense"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Kristian K Ullrich.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
